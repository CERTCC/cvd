{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://democert.org/cvd/report_methods.schema.json",
    "title": "Results or response to a vendor search by a security researcher",
    "description": "Results presented to a Vulnerability reporting discovery search for a vendor and product and version following CERT Coordinated Vulnerability Disclosure (CVD) guide 2021.08.1101",
    "type": "object",
    "properties": {
	"document_type": {
	    "type": "string",
	    "description": "A string representing the type of document that is being considered. Default report gives CERT's contact when no vendor-product matches in CERT's directory",
	    "enum": ["report_methods","default_report"]
	},
	"version": {
	    "type": "string",
	    "description": "Version of the vendor search protocol submitted",
	    "example": "1.0.0"
	},
	"title": {
	    "type": "string",
	    "description": "Optional title given to your search performed",
	    "example": "Search to report buffer overflow in Apache/httpd/2.0.1"
	},
	"stakeholders": {
	    "type": "array",
	    "description": "An array of search criterea presented by the security researcher for finding vendor contacts",
	    "minItems": 1,
	    "items": {
		"type": "object",
		"description": "Information about the stakeholder able to accept report from the security researcher",
		"properties": {
		    "type" : {
			"type": "string",
			"description": "Type of contact/stakeholder who is able to accept vulnerability report from the researcher",
			"enum": ["vendor","vendor_psirt","vendor_bugbounty","bugbounty_third_party","CERT","CSIRT"]
		    },
		    "name": {
			"type": "string",
			"description": "Official or Friendly name of the stakeholder able to accept the report",
			"examples": ["Microsoft","Apache","John Wayne"]
		    },
		    "method": {
			"type": "string",
			"description": "Methods in which the Stakeholder can be reached. Either email or web forms ",
			"enum": ["email","web","api","pgp_email","smime_email"]
		    },
		    "contact_url": {
			"type": "string",
			"format": "uri",
			"description": "URL of the stakeholder's contact method",
			"examples": ["https://google.com/security","mailto:security@intel.com"]
		    },
		    "access": {
			"type": "string",
			"description": "Access, if any, required to reach the stakeholder",
			"enum": ["public","registered_user","approval_required"]
		    },
		    "access_tokens": {
			"type": "array",
			"description": "Type of access verificaction(s) required for becoming a trusted user or reporter",
			"items": {
			    "type": "string",
			    "examples": ["password","2fa","oauth"]
			}
		    },
		    "access_security": {
			"type": "array",
			"description": "Type of secure communications methods supported by the stakeholder",
			"items" : {
			    "type": "string",
			    "enum": ["pgp","dane","smime","https"]
			}
		    },
		    "disclosure_rewards": {
			"type": "array",
			"description": "Type of rewards (financial and other) provided by the stakeholder for coordinated disclosure of vulnerabilities",
			"items": {
			    "type": "string",
			    "enum": ["bounty","swag","hall_of_fame"]
			}
		    },
		    "disclosure_timelines": {
			"type": "object",
			"type": "string",
			"format": "duration",
			"description": "ISO 8601 ABNF denotion of duration",
			"examples": ["30D"]
		    },
		    "fees": {
			"type": "string",
			"description": "Optional information on any type of fees to be paid to be in the Bug Bounty or security reporting program",
			"examples": ["USD100 one time","EUR20 yearly"]
		    },
		    "policy_url": {
			"type": "string",
			"description": "An URI where the policy with details of terms and conditions for reporting vulnerabilities is provided",
			"format": "uri"
		    },
		    "last_verified": {
			"type": "integer",
			"description": "Timestamp in UNIX epoch seconds on when the information was last verified to be active"
		    }
		    
		}
	    },
	    "required": ["type","name","method","url","access","access_tokens","policy_url","contact_url","last_verified"]
	},
	"inputs": {
	    "type": "array",
	    "minItems": 1,
	    "items": {
		"type": "object",
		"properties": {
		    "vendor_search_string": {
			"type": "string",
			"description": "Vendor value provided by the search"
		    },
		    "product_search_string": {
			"type": "string",
			"description": "Product value provided by the search"
		    },
		    "version_search_string": {
			"type": "string",
			"description": "Version value provided by the search"
		    }
		}
	    },
	    "required": ["vendor_search_string","product_search_string"]
	},
	"input_schema": {
	    "type": "string",
	    "format": "uri",
	    "description": "Full URI of the schema used for search submission"
	},
	"timestamp": {
	    "type": "integer",
	    "description": "Time in unix epoch of when the search was performed"
	}
    },
    "required": [ "document_type","version","stakeholders","inputs",
		  "input_schema", "timestamp"]
}
